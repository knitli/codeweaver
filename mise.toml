# SPDX-FileCopyrightText: 2025 Knitli Inc.
# SPDX-FileContributor: Adam Poulemanos <adam@knit.li>
#
# SPDX-License-Identifier: MIT OR Apache-2.0
[settings]
idiomatic_version_file_enable_tools = []
status.show_env = true

[settings.python]
uv_venv_auto = true
compile = true
uv_venv_create_args = [
    "--seed",
    "--keyring-provider",
    "subprocess",
    "--python",
    "3.13",
]

[tools]
"cargo:rust-parallel" = "latest"
"cargo:tree-sitter-cli" = "latest"
"pipx:changesets" = "latest"
"pipx:claude-monitor" = "latest"
"pipx:copychat" = "latest"
"pipx:fastmcp" = "latest"
"pipx:git+https://github.com/microsoft/mcp-interviewer.git" = "latest"
"pipx:mike" = "latest"
"pipx:mteb" = "latest"
"pipx:reuse" = "latest"
"pipx:tombi" = "latest"
"pipx:ty" = "latest"
ast-grep = "latest"
gh = "latest"
gitsign = "latest"
hk = "latest"
node = "24"
pkl = "latest"
python = "3.13"
ripgrep = "latest"
ruff = "latest"
shellcheck = "latest"
shfmt = "latest"
typos = "latest"
usage = "latest"
uv = "latest"

[env]
GH_REPO = "{{config_root}}"
REMOTE_ORIGIN_URL = '''http://github.com/knitli/codeweaver-mcp.git'''
# Use the project name derived from the current directory
PROJECT_NAME = "{{ config_root | basename }}"
CODEWEAVER_PROJECT_PATH = '''{{ config_root }}'''
CODEWEAVER_VERSION = '''{{ read_file(path='src/codeweaver/_version.py') | split(pat=' = "') | nth(n=1) | split(pat='"') | nth(n=0) | trim }}'''
CI = '''{{ exec(command='sh -c "if [ -z \"$GITHUB_ACTIONS\" ]; then echo \"false\"; else echo \"true\"; fi"') }}'''
_.path = [
    "scripts/dev-env",
    "scripts/code-quality",
    "scripts/build",
    "scripts/language-support",
    "scripts/testing",
    "scripts/utils",
    ".venv/bin",
]

[hooks]
[hooks.enter]
script = "mise run enter"

# NOTE: Between here and the `scripts` directory, our tasks are getting a bit crowded.
# TODO: We should combine the scripts/ and these tasks into the `mise-tasks` directory as standalone scripts.

[tasks]
[tasks.enter]
shell = "zsh -c"
silent = "stdout"
run = '''
case "$python_path" in
*.venv/bin/python*)
    # Already in venv, do nothing
    ;;
*)
    # Not in venv or python not found, source it
    source .venv/bin/activate 2>/dev/null || true
    ;;
esac
'''
run_windows = '''
$pythonPath = $env:python_path
if ($pythonPath -notlike "*.venv\Scripts\python*") {
    # Not in venv or python not found, source it
    if (Test-Path .venv\Scripts\Activate.ps1) {
        .venv\Scripts\Activate.ps1 2>$null
    }
}
'''

[tasks.enter.env]
GH_REPO = '''{{ env.GH_REPO | default(value=config_root) }}'''
ACTIVE_SHELL = '''{{ exec(command='basename "$SHELL" 2>/dev/null || echo zsh') }}'''
python_path = '''{{ exec(command='command -v python 2>/dev/null || echo ""') }}'''

[tasks.info]
description = "Print project information"
run = '''
echo "Project: $PROJECT_NAME"
echo "Virtual Environment: $VIRTUAL_ENV"
'''
run_windows = '''
Write-Host "Project: $env:PROJECT_NAME"
Write-Host "Virtual Environment: $env:VIRTUAL_ENV"
'''

[tasks.sync]
depends = ["source"]
tools.uv = "latest"
run = '''
echo "Syncing dependencies..."
uv sync --extra full --group dev --group docs --group build --group test
'''
run_windows = '''
Write-Host "Syncing dependencies..."
uv sync --extra full --group dev --group docs --group build --group test
'''

[tasks.update-dependencies]
tools.uv = "latest"
depends = ["source"]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Updating dependencies..."
uv sync --extra full --group dev --group docs --group build --group test -U
'''
run_windows = '''
Write-Host "[codeweaver] Updating dependencies..." -ForegroundColor DarkYellow
uv sync --extra full --group dev --group docs --group build --group test -U
'''

[tasks.source]
run = '''
#!/usr/bin/env zsh
# Source the virtual environment
print -P "%F{209}[codeweaver]%f Sourcing virtual environment..."
git rev-parse --show-toplevel || true
source .venv/bin/activate
'''
run_windows = '''
Write-Host "[codeweaver] Sourcing virtual environment..." -ForegroundColor DarkYellow
git rev-parse --show-toplevel
.venv\Scripts\Activate.ps1
'''

[tasks.update]
silent = "stdout"
alias = "update-tools"
shell = "zsh -c"
run = [
    "print -P \"%F{209}[codeweaver]%f Updating tools...\"",
    "mise -y upgrade",
    "mise -y self-update",
    "mise -y reshim",
    "mise -y prune",
    "print -P \"%F{209}[codeweaver]%f âœ… Tools updated! ðŸ§°\"",
]
run_windows = [
    "Write-Host '[codeweaver] Updating tools...' -ForegroundColor DarkYellow",
    "mise -y upgrade",
    "mise -y self-update",
    "mise -y reshim",
    "mise -y prune",
    "Write-Host '[codeweaver] âœ… Tools updated! ðŸ§°' -ForegroundColor DarkYellow",
]

[tasks.setup]
# Development setup
shell = "zsh -c"
run = [
    "print -P \"%F{209}[codeweaver]%f Setting up development environment for the first time...\"",
    "mise set &>/dev/null",
    "mise -y trust &>/dev/null",
    "mise -y install &>/dev/null || true",
    "mise -y venv &>/dev/null",
    "mise -y run sync &>/dev/null",
    "mise env &>/dev/null || true",
    "git config include.path .gitconfig &>/dev/null || true",
    "echo 'src/codeweaver/_version.py' >> .git/info/exclude",
    "echo 'coverage.xml' >> .git/info/exclude",
    "ln -sf AGENTS.md CLAUDE.md",
    "eval \"$(mise activate zsh)\" &>/dev/null",
]
run_windows = [
    "Write-Host '[codeweaver] Setting up development environment for the first time...' -ForegroundColor DarkYellow",
    "mise set > $null",
    "mise -y trust > $null",
    "mise -y install > $null",
    "mise -y venv > $null",
    "mise run sync > $null",
    "mise env > $null",
    "git config include.path .gitconfig > $null",
    "Add-Content -Path .git/info/exclude -Value 'src/codeweaver/_version.py'",
    "Add-Content -Path .git/info/exclude -Value 'coverage.xml'",
    "New-Item -ItemType SymbolicLink -Path CLAUDE.md -Target AGENTS.md -Force > $null",
    "(&mise activate pwsh) | Out-String | Invoke-Expression",
]
silent = "stdout"

[tasks.fix-python]
usage = '''
arg "[dir]" help="directories to fix" var=#true default="."
'''
run = [
    "uvx ruff format \"${usage_dir}\"",
    "uvx ruff check --fix --unsafe-fixes \"${usage_dir}\"",
]
run_windows = [
    "uvx ruff format \"$env:usage_dir\"",
    "uvx ruff check --fix --unsafe-fixes \"$env:usage_dir\"",
]
file = "scripts/code-quality/fix-ruff-patterns.sh"
sources = ["{src,scripts,tests}/*.py"]

[tasks.fix-other]
run = "hk fix"
run_windows = "hk fix"

[tasks.fix]
shell = "zsh -c"
run = ["mise run fix-other", "mise run fix-python"]
run_windows = ["mise run fix-other", "mise run fix-python"]
quiet = true

[tasks.check]
tools.hk = "latest"
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Running quality checks..."
hk check
'''
run_windows = '''
Write-Host "[codeweaver] Running quality checks..." -ForegroundColor DarkYellow
hk check
'''

[tasks.lint]
tools.uv = "latest"
run = '''
#!/bin/bash
echo "Running linting checks..."
if [[ "$CI" == "true" ]]; then
    uv run ruff check . --output-format=github
else
    uv run ruff check .
fi
'''
run_windows = '''
Write-Host "Running linting checks..."
if ($env:CI -eq "true") {
    uv run ruff check . --output-format=github
} else {
    uv run ruff check .
}
'''

[tasks.format]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Running formatting checks..."
hk check
'''
run_windows = '''
Write-Host "[codeweaver] Running formatting checks..." -ForegroundColor DarkYellow
hk check
'''

[tasks.format-fix]
tools."cargo:rust-parallel" = "latest"
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Applying formatting...hold onto your butts ðŸš¬...ðŸ¦– "
# mise run fix-ruff-patterns || {  # there are some bugs to work out
#    print -P "%F{209}[codeweaver]%f âš ï¸  %F{red}Ruff pattern fixer encountered issues.%f"}
uv run ruff format .
files="$(git ls-files "*.yaml" "*.yml" "*.json" 2>/dev/null)"
if [ -n "$files" ]; then
    echo "$files" | rust-parallel -d stderr -i - --no-run-if-empty yq -iP --indent=2 "." || true
fi
files="$(git ls-files "*.toml" 2>/dev/null)"
if [ -n "$files" ]; then
    tombi format $files 2>/dev/null || true
fi
'''
run_windows = '''
Write-Host "[codeweaver] Applying formatting...hold onto your butts ðŸš¬...ðŸ¦– " -ForegroundColor DarkYellow
uv run ruff format .
$files = git ls-files "*.yaml","*.yml","*.json" 2>$null
if ($files) {
    $files | ForEach-Object { yq -iP --indent=2 "." $_ 2>$null }
}
$files = git ls-files "*.toml" 2>$null
if ($files) {
    tombi format $files 2>$null
}
'''

[tasks.graph]
usage = '''
arg "[dir]" help="python directory to generate a graph for" default="src"
'''
run = '''mise x -- ruff analyze graph --target-version py312 --python .venv/bin/python "${usage_dir:-src/}"'''
run_windows = '''mise x -- ruff analyze graph --target-version py312 --python .venv\Scripts\python.exe "$env:usage_dir"'''

[tasks.venv]
shell = "zsh -c"
run = '''
print -P "%F{209}[codeweaver]%f Setting up Python virtual environment..."
uv venv --allow-existing --seed --keyring-provider subprocess --python 3.13 --refresh .venv &&
print -P "%F{209}[codeweaver]%f âœ… Virtual environment is ready!"
source .venv/bin/activate || print -P "%F{209}[codeweaver]%f âš ï¸  %F{red}Failed to source virtual environment.%f"
print -P "%F{209}[codeweaver]%f Running dependency sync..."
mise run sync &
'''
run_windows = '''
Write-Host "[codeweaver] Setting up Python virtual environment..." -ForegroundColor DarkYellow
uv venv --allow-existing --seed --keyring-provider subprocess --python 3.13 --refresh .venv
if ($LASTEXITCODE -eq 0) {
    Write-Host "[codeweaver] âœ… Virtual environment is ready!" -ForegroundColor DarkYellow
    .venv\Scripts\Activate.ps1
    if ($LASTEXITCODE -ne 0) {
        Write-Host "[codeweaver] âš ï¸  Failed to source virtual environment." -ForegroundColor Red
    }
}
Write-Host "[codeweaver] Running dependency sync..." -ForegroundColor DarkYellow
Start-Job -ScriptBlock { mise run sync }
'''

[tasks.test]
# Testing
usage = '''
args "[dir]" help="directory to test" default="tests/"
flag "--marks [markers]" help="pytest markers to filter tests" default=""

'''
run = '''
#!/bin/bash
echo "Running tests..."
uv run pytest
'''
run_windows = '''
Write-Host "Running tests..."
uv run pytest
'''

[tasks.test-cov]
run = '''
#!/bin/bash
echo "Running tests with coverage..."
uv run pytest tests/ --cov=codeweaver --cov-report=xml --cov-report=term-missing --junit-xml=test-results.xml -v
'''
run_windows = '''
Write-Host "Running tests with coverage..."
uv run pytest tests/ --cov=codeweaver --cov-report=xml --cov-report=term-missing --junit-xml=test-results.xml -v
'''

[tasks.test-watch]
run = '''
#!/bin/bash
echo "Running tests in watch mode..."
uv run pytest tests/ -f --tb=short
'''
run_windows = '''
Write-Host "Running tests in watch mode..."
uv run pytest tests/ -f --tb=short
'''

[tasks.build]
# Building and packaging
run = '''
#!/bin/bash
echo "Building package..."
uv build &&
echo "âœ… Package built successfully!"
'''
run_windows = '''
Write-Host "Building package..."
uv build
if ($LASTEXITCODE -eq 0) {
    Write-Host "âœ… Package built successfully!"
}
'''

[tasks.clean]
run = '''
#!/bin/bash
echo "Cleaning build artifacts..."
rm -rf dist/ build/ *.egg-info/ .coverage test-results.xml &&
find . -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null || true &&
find . -type f -name "*.pyc" -delete &&
echo "âœ… Build artifacts cleaned!"
'''
run_windows = '''
Write-Host "Cleaning build artifacts..."
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue dist/,build/,*.egg-info/,.coverage,test-results.xml
Get-ChildItem -Recurse -Directory -Filter __pycache__ | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue
Get-ChildItem -Recurse -Filter *.pyc | Remove-Item -Force -ErrorAction SilentlyContinue
Write-Host "âœ… Build artifacts cleaned!"
'''

# Documentation
[tasks.docs-serve]
tools.uv = "latest"
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Starting %F{209}CodeWeaver%f documentation server..."
uv run --group docs mkdocs serve
'''
run_windows = '''
Write-Host "[codeweaver] Starting CodeWeaver documentation server..." -ForegroundColor DarkYellow
uv run --group docs mkdocs serve
'''

[tasks.docs-build]
tools.uv = "latest"
run = '''
#!/bin/bash
echo "Building documentation..."
uv run --group docs mkdocs build
'''
run_windows = '''
Write-Host "Building documentation..."
uv run --group docs mkdocs build
'''

# Release and maintenance
[tasks.version]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver] CodeWeaver%f version information:"
print -P "%F{209}[codeweaver]%f ðŸ“¦ Package version: $(uv run python -c "import tomllib; print(tomllib.load(open('pyproject.toml', 'rb'))['project']['version'])")"
print -P "%F{209}[codeweaver]%f ðŸ Python version: $(python --version)"
print -P "%F{209}[codeweaver]%f ðŸŒž UV version: $(uv --version)"
'''
run_windows = '''
Write-Host "[codeweaver] CodeWeaver version information:" -ForegroundColor DarkYellow
$version = uv run python -c "import tomllib; print(tomllib.load(open('pyproject.toml', 'rb'))['project']['version'])"
Write-Host "[codeweaver] ðŸ“¦ Package version: $version" -ForegroundColor DarkYellow
Write-Host "[codeweaver] ðŸ Python version: $(python --version)" -ForegroundColor DarkYellow
Write-Host "[codeweaver] ðŸŒž UV version: $(uv --version)" -ForegroundColor DarkYellow
'''

[tasks.changelog]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Generating changelog..."
npm exec changeset version
'''
run_windows = '''
Write-Host "[codeweaver] Generating changelog..." -ForegroundColor DarkYellow
npm exec changeset version
'''

# Combined workflows
[tasks.ci]
run = [
    "mise run check",
    "mise run lint",
    "mise run format",
    "mise run test-cov",
    "mise run build",
]
description = "Run all CI checks."

[tasks.pre-commit]
shell = "zsh -c"
run = [
    "print -P \"%F{209}[codeweaver]%f Running %F{209}CodeWeaver%f pre-commit checks ðŸª... %F{38} Thanks for your contributions! You're pretty cool.%f ðŸš€\" || true",
    "hk fix || print -P \"%F{209}[codeweaver]%f âš ï¸  %F{red}You need to fix some issues%f before committing. %F{209}Do not pass go, do not collect 200 dollars.%f ðŸ’¸ ðŸ˜¦\" && exit 1",
    "git add .",
    "hk check || print -P \"%F{209}[codeweaver]%f âš ï¸  %F{red}You need to fix some issues before committing. Almost there!%f\" && exit 1",
    "print -P \"%F{209}[codeweaver]%f âœ… %F{green}All pre-commit checks passed! You're awesome!%f ðŸŽ‰ ... and they said the Kobiyashi Maru was unwinnable! ðŸ––\"",
]
run_windows = '''
Write-Host "[codeweaver] Running CodeWeaver pre-commit checks ðŸª... Thanks for your contributions! You're pretty cool. ðŸš€" -ForegroundColor DarkYellow
hk fix
if ($LASTEXITCODE -ne 0) {
    Write-Host "[codeweaver] âš ï¸  You need to fix some issues before committing. Do not pass go, do not collect `$200. ðŸ’¸ ðŸ˜¦" -ForegroundColor Red
    exit 1
}
git add .
hk check
if ($LASTEXITCODE -ne 0) {
    Write-Host "[codeweaver] âš ï¸  You need to fix some issues before committing. Almost there!" -ForegroundColor Red
    exit 1
}
git add .
Write-Host "[codeweaver] âœ… All pre-commit checks passed! You're awesome! ðŸŽ‰ ... and they said the Kobiyashi Maru was unwinnable! ðŸ––" -ForegroundColor Green
'''

#! SECTION Aliases/Shortcuts for Scripts in scripts/ directory
[tasks.fix-ruff-patterns]
alias = "ruff-pats"
description = "Fix ruff unfixable patterns in the codebase"
run = '''
#!/bin/bash
echo "Running ruff pattern fixer..."
./scripts/code-quality/fix-ruff-patterns.sh "${*}"
'''
run_windows = '''
Write-Host "Running ruff pattern fixer..."
bash scripts/code-quality/fix-ruff-patterns.sh $args
'''

[tasks.update-licenses]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Updating %F{209}CodeWeaver%f license headers :..."
uv run -s scripts/code-quality/update-licenses.py --interactive "${*}"
'''
run_windows = '''
Write-Host "[codeweaver] Updating CodeWeaver license headers..." -ForegroundColor DarkYellow
uv run -s scripts/code-quality/update-licenses.py --interactive $args
'''

[tasks.dev-shell-init]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Initializing development shell..."
./scripts/dev-env/dev-shell-init.zsh
'''

[tasks.install-mise]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Installing Mise..."
./scripts/dev-env/install-mise.sh
'''

[tasks.vscode-terminal-bootstrap]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Bootstrapping VSCode terminal..."
./scripts/dev-env/vscode-terminal-bootstrap.sh
'''

[tasks.add-plaintext-to-codeblock]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Adding 'plaintext' to unmarked code blocks in markdown files..."
uv run -s scripts/docs/add-plaintext-to-codeblock.py
'''
run_windows = '''
Write-Host "[codeweaver] Adding 'plaintext' to unmarked code blocks in markdown files..." -ForegroundColor DarkYellow
uv run -s scripts/docs/add-plaintext-to-codeblock.py
'''

[tasks.gen-ref-pages]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Generating docs reference pages..."
uv run -s scripts/docs/gen-ref-pages.py
'''
run_windows = '''
Write-Host "[codeweaver] Generating docs reference pages..." -ForegroundColor DarkYellow
uv run -s scripts/docs/gen-ref-pages.py
'''

[tasks.analyze-grammar-structure]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Analyzing grammar structure..."
uv run -s scripts/language-support/analyze-grammar-structure.py
'''
run_windows = '''
Write-Host "[codeweaver] Analyzing grammar structure..." -ForegroundColor DarkYellow
uv run -s scripts/language-support/analyze-grammar-structure.py
'''

[tasks.build-language-mappings]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Building language mappings..."
uv run -s scripts/language-support/build-language-mappings.py
'''
run_windows = '''
Write-Host "[codeweaver] Building language mappings..." -ForegroundColor DarkYellow
uv run -s scripts/language-support/build-language-mappings.py
'''

[tasks.compare-delimiters]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Comparing delimiters..."
uv run -s scripts/language-support/compare-delimiters.py
'''
run_windows = '''
Write-Host "[codeweaver] Comparing delimiters..." -ForegroundColor DarkYellow
uv run -s scripts/language-support/compare-delimiters.py
'''

[tasks.download-ts-grammars]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Downloading tree-sitter grammars..."
uv run -s scripts/language-support/download-ts-grammars.py "${*}"
'''
run_windows = '''
Write-Host "[codeweaver] Downloading tree-sitter grammars..." -ForegroundColor DarkYellow
uv run -s scripts/language-support/download-ts-grammars.py $args
'''

[tasks.generate-delimiters]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Generating delimiters..."
uv run -s scripts/language-support/generate-delimiters.py
'''
run_windows = '''
Write-Host "[codeweaver] Generating delimiters..." -ForegroundColor DarkYellow
uv run -s scripts/language-support/generate-delimiters.py
'''

[tasks.generate-supported-languages]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Generating supported languages..."
uv run -s scripts/build/generate-supported-languages.py
'''
run_windows = '''
Write-Host "[codeweaver] Generating supported languages..." -ForegroundColor DarkYellow
uv run -s scripts/build/generate-supported-languages.py
'''

[tasks.mteb-to-codeweaver]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Converting MTEB model data to CodeWeaver format..."
uv run -s scripts/model-data/mteb-to-codeweaver.py "${*}"
'''
run_windows = '''
Write-Host "[codeweaver] Converting MTEB model data to CodeWeaver format..." -ForegroundColor DarkYellow
uv run -s scripts/model-data/mteb-to-codeweaver.py $args
'''

[tasks.apply-test-marks]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Applying test marks to tests..."
uv run -s scripts/testing/apply-test-marks.py "${*}"
'''
run_windows = '''
Write-Host "[codeweaver] Applying test marks to tests..." -ForegroundColor DarkYellow
uv run -s scripts/testing/apply-test-marks.py $args
'''

[tasks.benchmark-detection]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Running benchmark detection..."
uv run -s scripts/testing/benchmark-detection.py "${*}"
'''
run_windows = '''
Write-Host "[codeweaver] Running benchmark detection..." -ForegroundColor DarkYellow
uv run -s scripts/testing/benchmark-detection.py $args
'''

[tasks.ansi-color-tests]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Checking ANSI color codes..."
uv run -s scripts/utils/ansi-color-tests.py "${*}"
'''
run_windows = '''
Write-Host "[codeweaver] Checking ANSI color codes..." -ForegroundColor DarkYellow
uv run -s scripts/utils/ansi-color-tests.py $args
'''

[tasks.check-imports]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Checking imports..."
uv run -s scripts/utils/check-imports.py "${*}"
'''
run_windows = '''
Write-Host "[codeweaver] Checking imports..." -ForegroundColor DarkYellow
uv run -s scripts/utils/check-imports.py $args
'''

[tasks.get-all-exceptions]
run = '''
#!/usr/bin/env zsh
print -P "%F{209}[codeweaver]%f Getting all exceptions..."
uv run -s scripts/utils/get-all-exceptions.py "${*}"
'''
run_windows = '''
Write-Host "[codeweaver] Getting all exceptions..." -ForegroundColor DarkYellow
uv run -s scripts/utils/get-all-exceptions.py $args
'''

[tasks.activate]
run = '''eval "$(mise activate zsh)" &>/dev/null'''
run_windows = '''(&mise activate pwsh) | Out-String | Invoke-Expression'''
hide = true
