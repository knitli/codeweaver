[38;5;238mâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
     [38;5;238mâ”‚ [0m[1mSTDIN[0m
[38;5;238mâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[38;5;238m   1[0m [38;5;238mâ”‚[0m [38;2;248;248;242m// SPDX-FileCopyrightText: 2025 Knitli Inc.[0m
[38;5;238m   2[0m [38;5;238mâ”‚[0m [38;2;248;248;242m// SPDX-License-Identifier: MIT OR Apache-2.0[0m
[38;5;238m   3[0m [38;5;238mâ”‚[0m 
[38;5;238m   4[0m [38;5;238mâ”‚[0m [38;2;248;248;242m/**[0m
[38;5;238m   5[0m [38;5;238mâ”‚[0m [38;2;248;248;242m * Sample JavaScript module for testing chunker functionality.[0m
[38;5;238m   6[0m [38;5;238mâ”‚[0m [38;2;248;248;242m * Contains nested functions, closures, and class definitions.[0m
[38;5;238m   7[0m [38;5;238mâ”‚[0m [38;2;248;248;242m */[0m
[38;5;238m   8[0m [38;5;238mâ”‚[0m 
[38;5;238m   9[0m [38;5;238mâ”‚[0m [38;2;248;248;242mclass TaskQueue {[0m
[38;5;238m  10[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  constructor(maxConcurrency = 5) {[0m
[38;5;238m  11[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    this.maxConcurrency = maxConcurrency;[0m
[38;5;238m  12[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    this.queue = [];[0m
[38;5;238m  13[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    this.running = 0;[0m
[38;5;238m  14[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  }[0m
[38;5;238m  15[0m [38;5;238mâ”‚[0m 
[38;5;238m  16[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  async enqueue(task) {[0m
[38;5;238m  17[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    return new Promise((resolve, reject) => {[0m
[38;5;238m  18[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      this.queue.push({ task, resolve, reject });[0m
[38;5;238m  19[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      this.processNext();[0m
[38;5;238m  20[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    });[0m
[38;5;238m  21[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  }[0m
[38;5;238m  22[0m [38;5;238mâ”‚[0m 
[38;5;238m  23[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  async processNext() {[0m
[38;5;238m  24[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    if (this.running >= this.maxConcurrency || this.queue.length === 0) {[0m
[38;5;238m  25[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      return;[0m
[38;5;238m  26[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    }[0m
[38;5;238m  27[0m [38;5;238mâ”‚[0m 
[38;5;238m  28[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    this.running++;[0m
[38;5;238m  29[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    const { task, resolve, reject } = this.queue.shift();[0m
[38;5;238m  30[0m [38;5;238mâ”‚[0m 
[38;5;238m  31[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    try {[0m
[38;5;238m  32[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      const result = await task();[0m
[38;5;238m  33[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      resolve(result);[0m
[38;5;238m  34[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    } catch (error) {[0m
[38;5;238m  35[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      reject(error);[0m
[38;5;238m  36[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    } finally {[0m
[38;5;238m  37[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      this.running--;[0m
[38;5;238m  38[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      this.processNext();[0m
[38;5;238m  39[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    }[0m
[38;5;238m  40[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  }[0m
[38;5;238m  41[0m [38;5;238mâ”‚[0m [38;2;248;248;242m}[0m
[38;5;238m  42[0m [38;5;238mâ”‚[0m 
[38;5;238m  43[0m [38;5;238mâ”‚[0m [38;2;248;248;242mfunction createDataProcessor(config) {[0m
[38;5;238m  44[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  const cache = new Map();[0m
[38;5;238m  45[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  const stats = { hits: 0, misses: 0 };[0m
[38;5;238m  46[0m [38;5;238mâ”‚[0m 
[38;5;238m  47[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  function processItem(item) {[0m
[38;5;238m  48[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    const cached = cache.get(item.id);[0m
[38;5;238m  49[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    if (cached) {[0m
[38;5;238m  50[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      stats.hits++;[0m
[38;5;238m  51[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      return cached;[0m
[38;5;238m  52[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    }[0m
[38;5;238m  53[0m [38;5;238mâ”‚[0m 
[38;5;238m  54[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    stats.misses++;[0m
[38;5;238m  55[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    const result = {[0m
[38;5;238m  56[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      id: item.id,[0m
[38;5;238m  57[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      value: transformValue(item.value),[0m
[38;5;238m  58[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      timestamp: Date.now()[0m
[38;5;238m  59[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    };[0m
[38;5;238m  60[0m [38;5;238mâ”‚[0m 
[38;5;238m  61[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    cache.set(item.id, result);[0m
[38;5;238m  62[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    return result;[0m
[38;5;238m  63[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  }[0m
[38;5;238m  64[0m [38;5;238mâ”‚[0m 
[38;5;238m  65[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  function transformValue(value) {[0m
[38;5;238m  66[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    return config.multiplier ? value * config.multiplier : value;[0m
[38;5;238m  67[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  }[0m
[38;5;238m  68[0m [38;5;238mâ”‚[0m 
[38;5;238m  69[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  function getStats() {[0m
[38;5;238m  70[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    return { ...stats };[0m
[38;5;238m  71[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  }[0m
[38;5;238m  72[0m [38;5;238mâ”‚[0m 
[38;5;238m  73[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  return {[0m
[38;5;238m  74[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    process: processItem,[0m
[38;5;238m  75[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    stats: getStats,[0m
[38;5;238m  76[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    cache[0m
[38;5;238m  77[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  };[0m
[38;5;238m  78[0m [38;5;238mâ”‚[0m [38;2;248;248;242m}[0m
[38;5;238m  79[0m [38;5;238mâ”‚[0m 
[38;5;238m  80[0m [38;5;238mâ”‚[0m [38;2;248;248;242mconst withRetry = (fn, maxAttempts = 3) => {[0m
[38;5;238m  81[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  return async (...args) => {[0m
[38;5;238m  82[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    let lastError;[0m
[38;5;238m  83[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    [0m
[38;5;238m  84[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    for (let attempt = 1; attempt <= maxAttempts; attempt++) {[0m
[38;5;238m  85[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      try {[0m
[38;5;238m  86[0m [38;5;238mâ”‚[0m [38;2;248;248;242m        return await fn(...args);[0m
[38;5;238m  87[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      } catch (error) {[0m
[38;5;238m  88[0m [38;5;238mâ”‚[0m [38;2;248;248;242m        lastError = error;[0m
[38;5;238m  89[0m [38;5;238mâ”‚[0m [38;2;248;248;242m        if (attempt < maxAttempts) {[0m
[38;5;238m  90[0m [38;5;238mâ”‚[0m [38;2;248;248;242m          await new Promise(resolve => setTimeout(resolve, 1000 * attempt));[0m
[38;5;238m  91[0m [38;5;238mâ”‚[0m [38;2;248;248;242m        }[0m
[38;5;238m  92[0m [38;5;238mâ”‚[0m [38;2;248;248;242m      }[0m
[38;5;238m  93[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    }[0m
[38;5;238m  94[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    [0m
[38;5;238m  95[0m [38;5;238mâ”‚[0m [38;2;248;248;242m    throw lastError;[0m
[38;5;238m  96[0m [38;5;238mâ”‚[0m [38;2;248;248;242m  };[0m
[38;5;238m  97[0m [38;5;238mâ”‚[0m [38;2;248;248;242m};[0m
[38;5;238m  98[0m [38;5;238mâ”‚[0m 
[38;5;238m  99[0m [38;5;238mâ”‚[0m [38;2;248;248;242mmodule.exports = { TaskQueue, createDataProcessor, withRetry };[0m
[38;5;238mâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
