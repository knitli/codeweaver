# SPDX-FileCopyrightText: 2025 Knitli Inc.
# SPDX-FileContributor: Adam Poulemanos <adam@knit.li>
#
# SPDX-License-Identifier: MIT OR Apache-2.0
# This schema won't exist until we merge this branch with main, at which time, we can remove the comment.
# "$schema" = "https://raw.githubusercontent.com/knitli/codeweaver/refs/heads/main/schema/codeweaver.schema.json"
project_path = "."
project_name = "codeweaver"
token_limit = 30000
max_file_size = 1048576
max_results = 30

[provider]
agent = [
  { provider = "anthropic", enabled = true, model = "claude-haiku-4.5", model_settings = {  } },
]
data = [
  { provider = "tavily", enabled = true },
  { provider = "duckduckgo", enabled = true },
]
embedding = [
  { provider = "voyage", enabled = true, model_settings = { model = "voyage-code-3" } },
]
reranking = [
  { provider = "voyage", enabled = true, model_settings = { model = "rerank-2.5" } },
]
vector_store = [
  { provider = "qdrant", enabled = true },
]
sparse_embedding = [
  { provider = "fastembed", enabled = true, model_settings = { model = "prithivida/Splade_PP_en_v1" } },
]

[server]
on_duplicate_tools = "replace"
on_duplicate_resources = "replace"
on_duplicate_prompts = "replace"
resource_prefix_format = "path"

[logging]
name = "codeweaver"
level = 30
use_rich = true

[middleware.error_handling]
transform_errors = false

[middleware.retry]
max_retries = 5
base_delay = 1.0
max_delay = 60.0
backoff_multiplier = 2.0

[middleware.logging]
log_level = 30
include_payloads = false

[middleware.rate_limiting]
max_requests_per_second = 75
burst_capacity = 150
global_limit = true

[indexer]
excludes = [
  "tests/fixtures/deep_nesting.py",
  "tests/fixtures/malformed.py",
  "tests/fixtures/sample.go",
  "data/**",
  "specs/**",
  "plans/**",
]
